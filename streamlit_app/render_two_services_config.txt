# ===============================
# RENDER TWO-SERVICE CONFIGURATION
# ===============================

# Service 1: API Service
name: golf-availability-api
type: web
env: python
runtime: python-3.11
buildCommand: pip install -r requirements.txt
startCommand: python streamlit_app/render_api_server.py
envVars:
  - key: PYTHON_VERSION
    value: 3.11.0
  - key: PORT
    value: 10000
  - key: DATA_STORAGE_MODE
    value: render
  - key: API_MODE
    value: production

# Expected URL: https://golf-availability-api.onrender.com

# ===============================

# Service 2: UI Service (Streamlit)
name: golf-availability-ui
type: web
env: python
runtime: python-3.11
buildCommand: pip install -r streamlit_app/requirements.txt
startCommand: streamlit run streamlit_app/render_streamlit_app.py --server.port=$PORT --server.address=0.0.0.0
envVars:
  - key: PYTHON_VERSION
    value: 3.11.0
  - key: PORT
    value: 10000
  - key: API_BASE_URL
    value: https://golf-availability-api.onrender.com

# Expected URL: https://golf-availability-ui.onrender.com

# ===============================
# DEPLOYMENT INSTRUCTIONS
# ===============================

# 1. Deploy API Service First:
#    - Create new Web Service in Render
#    - Connect to GitHub repository
#    - Set name: golf-availability-api
#    - Set build command: pip install -r requirements.txt
#    - Set start command: python streamlit_app/render_api_server.py
#    - Add environment variables as listed above
#    - Deploy and wait for success

# 2. Deploy UI Service Second:
#    - Create new Web Service in Render
#    - Connect to same GitHub repository
#    - Set name: golf-availability-ui
#    - Set build command: pip install -r streamlit_app/requirements.txt
#    - Set start command: streamlit run streamlit_app/render_streamlit_app.py --server.port=$PORT --server.address=0.0.0.0
#    - Add environment variables as listed above
#    - IMPORTANT: Set API_BASE_URL to the actual API service URL from step 1
#    - Deploy

# 3. Update API_BASE_URL:
#    - After API service is deployed, note the URL (e.g., https://golf-availability-api.onrender.com)
#    - Update UI service environment variable API_BASE_URL with the actual API URL
#    - Redeploy UI service

# 4. Test:
#    - Visit UI URL: https://golf-availability-ui.onrender.com
#    - Check that API connection shows green in sidebar
#    - Test profile creation and saving
#    - Verify data persistence between sessions
